


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial: Adding a dataset &mdash; MMF 1.0.0rc8 documentation</title>
  

  
  
  
  
    <link rel="canonical" href="/tutorials/dataset.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/css/customize.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial: Late Fusion" href="late_fusion.html" />
    <link rel="prev" title="Terminology and Concepts" href="concepts.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://mmf.sh/" aria-label="MMF"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://mmf.sh/get-started">Get Started</a>
          </li>


          <li>
            <a href="https://mmf.sh/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://mmf.sh/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://github.com/facebookresearch/mmf">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  1.0.0
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/quickstart.html">Quickstart </a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/pretrained_models.html">Pretrained Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/configuration.html">Configuration System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/challenge.html">Challenge Participation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/faq.html">FAQs</a></li>
</ul>
<p class="caption"><span class="caption-text">Challenges</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/hateful_memes_challenge.html">Hateful Memes</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending MMF</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Terminology and Concepts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial: Adding a dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="late_fusion.html">Tutorial: Late Fusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="mmf_bert.html">Tutorial: Detect Hate Speech with MMFBERT</a></li>
</ul>
<p class="caption"><span class="caption-text">Library Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lib/common/registry.html">common.registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/common/sample.html">common.sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/models/base_model.html">models.base_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/modules/losses.html">modules.losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/modules/metrics.html">modules.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/datasets/base_dataset_builder.html">datasets.base_dataset_builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/datasets/base_dataset.html">datasets.base_dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/datasets/processors.html">datasets.processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/utils/text.html">utils.text</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Tutorial: Adding a dataset</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            
              <!-- User defined GitHub URL -->
              <a href="https://github.com/facebookresearch/mmf" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="tutorial-adding-a-dataset">
<h1>Tutorial: Adding a dataset<a class="headerlink" href="#tutorial-adding-a-dataset" title="Permalink to this headline">¶</a></h1>
<p><strong>[Outdated]</strong> A new version of this will be uploaded soon</p>
<p># MMF</p>
<p>This is a tutorial on how to add a new dataset to MMF.</p>
<p>MMF is agnostic to kind of datasets that can be added to it. On high level, adding a dataset requires 4 main components.</p>
<ul class="simple">
<li><p>Dataset Builder</p></li>
<li><p>Default Configuration</p></li>
<li><p>Dataset Class</p></li>
<li><p>Dataset’s Metrics</p></li>
</ul>
<p>In most of the cases, you should be able to inherit one of the existing datasets for easy integration. Let’s start from the dataset builder</p>
<div class="section" id="dataset-builder">
<h2>Dataset Builder<a class="headerlink" href="#dataset-builder" title="Permalink to this headline">¶</a></h2>
<p>Builder creates and returns an instance of <a class="reference internal" href="../lib/datasets/base_dataset.html#mmf.datasets.base_dataset.BaseDataset" title="mmf.datasets.base_dataset.BaseDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmf.datasets.base_dataset.BaseDataset</span></code></a> which is inherited from <code class="docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Dataset</span></code>.
Any builder class in MMF needs to be inherited from <a class="reference internal" href="../lib/datasets/base_dataset_builder.html#mmf.datasets.base_dataset_builder.BaseDatasetBuilder" title="mmf.datasets.base_dataset_builder.BaseDatasetBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmf.datasets.base_dataset_builder.BaseDatasetBuilder</span></code></a>. <a class="reference internal" href="../lib/datasets/base_dataset_builder.html#mmf.datasets.base_dataset_builder.BaseDatasetBuilder" title="mmf.datasets.base_dataset_builder.BaseDatasetBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDatasetBuilder</span></code></a> requires
user to implement following methods after inheriting the class.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__(self):</span></code></p></li>
</ul>
<p>Inside this function call super().__init__(“name”) where “name” should your dataset’s name like “vqa2”.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">load(self,</span> <span class="pre">config,</span> <span class="pre">dataset_type,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code></p></li>
</ul>
<p>This function loads the dataset, builds an object of class inheriting <a class="reference internal" href="../lib/datasets/base_dataset.html#mmf.datasets.base_dataset.BaseDataset" title="mmf.datasets.base_dataset.BaseDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataset</span></code></a> which contains your dataset logic and returns it.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">build(self,</span> <span class="pre">config,</span> <span class="pre">dataset_type,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code></p></li>
</ul>
<p>This function actually builds the data required for initializing the dataset for the first time. For e.g. if you need to download some data for your dataset, this
all should be done inside this function.</p>
<p>Finally, you need to register your dataset builder with a key to registry using <code class="docutils literal notranslate"><span class="pre">mmf.common.registry.registry.register_builder(&quot;key&quot;)</span></code>.</p>
<p>That’s it, that’s all you require for inheriting <a class="reference internal" href="../lib/datasets/base_dataset_builder.html#mmf.datasets.base_dataset_builder.BaseDatasetBuilder" title="mmf.datasets.base_dataset_builder.BaseDatasetBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDatasetBuilder</span></code></a>.</p>
<p>Let’s write down this using example of <em>CLEVR</em> dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="kn">from</span> <span class="nn">mmf.common.registry</span> <span class="kn">import</span> <span class="n">registry</span>
<span class="kn">from</span> <span class="nn">mmf.datasets.base_dataset_builder</span> <span class="kn">import</span> <span class="n">BaseDatasetBuilder</span>
<span class="c1"># Let&#39;s assume for now that we have a dataset class called CLEVRDataset</span>
<span class="kn">from</span> <span class="nn">mmf.datasets.builders.clevr.dataset</span> <span class="kn">import</span> <span class="n">CLEVRDataset</span>
<span class="kn">from</span> <span class="nn">mmf.utils.general</span> <span class="kn">import</span> <span class="n">download_file</span><span class="p">,</span> <span class="n">get_mmf_root</span>

<span class="nd">@registry</span><span class="o">.</span><span class="n">register_builder</span><span class="p">(</span><span class="s2">&quot;clevr&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CLEVRBuilder</span><span class="p">(</span><span class="n">BaseDatasetBuilder</span><span class="p">):</span>
    <span class="n">DOWNLOAD_URL</span> <span class="o">=</span> <span class="s2">&quot;https://s3-us-west-1.amazonaws.com/clevr/CLEVR_v1.0.zip&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Init should call super().__init__ with the key for the dataset</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;clevr&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;writer&quot;</span><span class="p">)</span>

        <span class="c1"># Assign the dataset class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_class</span> <span class="o">=</span> <span class="n">CLEVRDataset</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">download_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">get_mmf_root</span><span class="p">(),</span> <span class="n">config</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">data_folder</span>
        <span class="p">)</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DOWNLOAD_URL</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">local_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>

        <span class="n">extraction_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_folder</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">=</span> <span class="n">extraction_folder</span>

        <span class="c1"># Either if the zip file is already present or if there are some</span>
        <span class="c1"># files inside the folder we don&#39;t continue download process</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">local_filename</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">extraction_folder</span><span class="p">)</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">extraction_folder</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Downloading the CLEVR dataset now&quot;</span><span class="p">)</span>
        <span class="n">download_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DOWNLOAD_URL</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">download_folder</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Downloaded. Extracting now. This can take time.&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
            <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">download_folder</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Load the dataset using the CLEVRDataset class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">CLEVRDataset</span><span class="p">(</span>
            <span class="n">config</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">data_folder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span>

    <span class="k">def</span> <span class="nf">update_registry_for_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="c1"># Register both vocab (question and answer) sizes to registry for easy access to the</span>
        <span class="c1"># models. update_registry_for_model function if present is automatically called by</span>
        <span class="c1"># MMF</span>
        <span class="n">registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s2">&quot;_text_vocab_size&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">text_processor</span><span class="o">.</span><span class="n">get_vocab_size</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">registry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s2">&quot;_num_final_outputs&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">answer_processor</span><span class="o">.</span><span class="n">get_vocab_size</span><span class="p">(),</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="default-configuration">
<h2>Default Configuration<a class="headerlink" href="#default-configuration" title="Permalink to this headline">¶</a></h2>
<p>Some things to note about MMF’s configuration:</p>
<ul class="simple">
<li><p>Each dataset in MMF has its own default configuration which is usually under this structure
<code class="docutils literal notranslate"><span class="pre">mmf/common/defaults/configs/datasets/[task]/[dataset].yaml</span></code> where <code class="docutils literal notranslate"><span class="pre">task</span></code> is the task your dataset belongs to.</p></li>
<li><p>These dataset configurations can be then included by the user in their end config using <code class="docutils literal notranslate"><span class="pre">includes</span></code> directive</p></li>
<li><p>This allows easy multi-tasking and management of configurations and user can also override the default configurations
easily in their own config</p></li>
</ul>
<p>So, for CLEVR dataset also, we will need to create a default configuration.</p>
<p>The config node is directly passed to your builder which you can then pass to your dataset for any configuration that you need
for building your dataset.</p>
<p>Basic structure for a dataset configuration looks like below:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dataset_config</span><span class="p">:</span>
    <span class="p p-Indicator">[</span><span class="nv">dataset</span><span class="p p-Indicator">]:</span>
        <span class="l l-Scalar l-Scalar-Plain">... your config here</span>
</pre></div>
</div>
<p>Here, is a default configuration for CLEVR needed based on our dataset and builder class above:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dataset_config</span><span class="p">:</span>
    <span class="c1"># You can specify any attributes you want, and you will get them as attributes</span>
    <span class="c1"># inside the config passed to the dataset. Check the Dataset implementation below.</span>
    <span class="nt">clevr</span><span class="p">:</span>
        <span class="c1"># Where your data is stored</span>
        <span class="nt">data_dir</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${env.data_dir}</span>
        <span class="nt">data_folder</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CLEVR_v1.0</span>
        <span class="c1"># Any attribute that you require to build your dataset but are configurable</span>
        <span class="c1"># For CLEVR, we have attributes that can be passed to vocab building class</span>
        <span class="nt">build_attributes</span><span class="p">:</span>
            <span class="nt">min_count</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
            <span class="nt">split_regex</span><span class="p">:</span> <span class="s">&quot;</span><span class="nv"> </span><span class="s">&quot;</span>
            <span class="nt">keep</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="s">&quot;;&quot;</span>
                <span class="p p-Indicator">-</span> <span class="s">&quot;,&quot;</span>
            <span class="nt">remove</span><span class="p">:</span>
                <span class="p p-Indicator">-</span> <span class="s">&quot;?&quot;</span>
                <span class="p p-Indicator">-</span> <span class="s">&quot;.&quot;</span>
        <span class="nt">processors</span><span class="p">:</span>
        <span class="c1"># The processors will be assigned to the datasets automatically by MMF</span>
        <span class="c1"># For example if key is text_processor, you can access that processor inside</span>
        <span class="c1"># dataset object using self.text_processor</span>
            <span class="nt">text_processor</span><span class="p">:</span>
                <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vocab</span>
                <span class="nt">params</span><span class="p">:</span>
                    <span class="nt">max_length</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
                    <span class="nt">vocab</span><span class="p">:</span>
                        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">random</span>
                        <span class="nt">vocab_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vocabs/clevr_question_vocab.txt</span>
                <span class="c1"># You can also specify a processor here</span>
                <span class="nt">preprocessor</span><span class="p">:</span>
                    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">simple_sentence</span>
                    <span class="nt">params</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
            <span class="nt">answer_processor</span><span class="p">:</span>
                <span class="c1"># Add your processor for answer processor here</span>
                <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">multi_hot_answer_from_vocab</span>
                <span class="nt">params</span><span class="p">:</span>
                    <span class="nt">num_answers</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
                    <span class="c1"># Vocab file is relative to [data_dir]/[data_folder]</span>
                    <span class="nt">vocab_file</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vocabs/clevr_answer_vocab.txt</span>
                    <span class="nt">preprocessor</span><span class="p">:</span>
                        <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">simple_word</span>
                        <span class="nt">params</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</pre></div>
</div>
<p>For processors, check <a class="reference internal" href="../lib/datasets/processors.html#module-mmf.datasets.processors" title="mmf.datasets.processors"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmf.datasets.processors</span></code></a> to understand how to create a processor and different processors that are
already available in MMF.</p>
</div>
<div class="section" id="dataset-class">
<h2>Dataset Class<a class="headerlink" href="#dataset-class" title="Permalink to this headline">¶</a></h2>
<p>Next step is to actually build a dataset class which inherits <a class="reference internal" href="../lib/datasets/base_dataset.html#mmf.datasets.base_dataset.BaseDataset" title="mmf.datasets.base_dataset.BaseDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataset</span></code></a> so it can interact with PyTorch
dataloaders. Follow the steps below to inherit and create your dataset’s class.</p>
<ul class="simple">
<li><p>Inherit <a class="reference internal" href="../lib/datasets/base_dataset.html#mmf.datasets.base_dataset.BaseDataset" title="mmf.datasets.base_dataset.BaseDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmf.datasets.base_dataset.BaseDataset</span></code></a></p></li>
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">config,</span> <span class="pre">dataset)</span></code>. Call parent’s init using <code class="docutils literal notranslate"><span class="pre">super().__init__(&quot;name&quot;,</span> <span class="pre">config,</span> <span class="pre">dataset)</span></code>
where “name” is the string representing the name of your dataset.</p></li>
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">__getitem__(self,</span> <span class="pre">idx)</span></code>, our replacement for normal <code class="docutils literal notranslate"><span class="pre">__getitem__(self,</span> <span class="pre">idx)</span></code> you would implement for a torch dataset. This needs to
return an object of class :class:Sample.</p></li>
<li><p>Implement <code class="docutils literal notranslate"><span class="pre">__len__(self)</span></code> method, which represents size of your dataset.</p></li>
<li><p>[Optional] Implement <code class="docutils literal notranslate"><span class="pre">load_item(self,</span> <span class="pre">idx)</span></code> if you need to load something or do something else with data and then call it inside <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="kn">from</span> <span class="nn">mmf.common.registry</span> <span class="kn">import</span> <span class="n">registry</span>
<span class="kn">from</span> <span class="nn">mmf.common.sample</span> <span class="kn">import</span> <span class="n">Sample</span>
<span class="kn">from</span> <span class="nn">mmf.datasets.base_dataset</span> <span class="kn">import</span> <span class="n">BaseDataset</span>
<span class="kn">from</span> <span class="nn">mmf.utils.general</span> <span class="kn">import</span> <span class="n">get_mmf_root</span>
<span class="kn">from</span> <span class="nn">mmf.utils.text</span> <span class="kn">import</span> <span class="n">VocabFromText</span><span class="p">,</span> <span class="n">tokenize</span>


<span class="k">class</span> <span class="nc">CLEVRDataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">data_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;clevr&quot;</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span> <span class="o">=</span> <span class="n">data_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_mmf_root</span><span class="p">(),</span> <span class="n">config</span><span class="o">.</span><span class="n">data_dir</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_dir</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">data_folder</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Data folder </span><span class="si">{}</span><span class="s2"> for CLEVR is not present&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Check if the folder was actually extracted in the subfolder</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">data_folder</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">data_folder</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;CLEVR dataset folder is empty&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_load</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">,</span> <span class="s2">&quot;images&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_type</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_folder</span><span class="p">,</span>
                <span class="s2">&quot;questions&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CLEVR_</span><span class="si">{}</span><span class="s2">_questions.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_type</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">questions</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="s2">&quot;questions&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_vocab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">questions</span><span class="p">,</span> <span class="s2">&quot;question&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_build_vocab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">questions</span><span class="p">,</span> <span class="s2">&quot;answer&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># __len__ tells how many samples are there</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">questions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_vocab_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_dir</span><span class="p">,</span> <span class="s2">&quot;vocabs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">_vocab.txt&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_build_vocab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">questions</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="c1"># This function builds vocab for questions and answers but not required for the</span>
        <span class="c1"># tutorial</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="c1"># Get item is like your normal __getitem__ in PyTorch Dataset. Based on id</span>
        <span class="c1"># return a sample. Check VQA2Dataset implementation if you want to see how</span>
        <span class="c1"># to do caching in MMF</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">questions</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="c1"># Each call to __getitem__ from dataloader returns a Sample class object which</span>
        <span class="c1"># collated by our special batch collator to a SampleList which is basically</span>
        <span class="c1"># a attribute based batch in layman terms</span>
        <span class="n">current_sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">()</span>

        <span class="n">question</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;question&quot;</span><span class="p">]</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">],</span> <span class="n">remove</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">])</span>

        <span class="c1"># This processors are directly assigned as attributes to dataset based on the config</span>
        <span class="c1"># we created above</span>
        <span class="n">processed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_processor</span><span class="p">({</span><span class="s2">&quot;tokens&quot;</span><span class="p">:</span> <span class="n">tokens</span><span class="p">})</span>
        <span class="c1"># Add the question as text attribute to the sample</span>
        <span class="n">current_sample</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">processed</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>

        <span class="n">processed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">answer_processor</span><span class="p">({</span><span class="s2">&quot;answers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;answer&quot;</span><span class="p">]]})</span>
        <span class="c1"># Now add answers and then the targets. We normally use &quot;targets&quot; for what</span>
        <span class="c1"># should be the final output from the model in MMF</span>
        <span class="n">current_sample</span><span class="o">.</span><span class="n">answers</span> <span class="o">=</span> <span class="n">processed</span><span class="p">[</span><span class="s2">&quot;answers&quot;</span><span class="p">]</span>
        <span class="n">current_sample</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">processed</span><span class="p">[</span><span class="s2">&quot;answers_scores&quot;</span><span class="p">]</span>

        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_path</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;image_filename&quot;</span><span class="p">])</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">true_divide</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">),</span> <span class="mi">255</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="c1"># Process and add image as a tensor</span>
        <span class="n">current_sample</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Return your sample and MMF will automatically convert it to SampleList before</span>
        <span class="c1"># passing to the model</span>
        <span class="k">return</span> <span class="n">current_sample</span>
</pre></div>
</div>
</div>
<div class="section" id="metrics">
<h2>Metrics<a class="headerlink" href="#metrics" title="Permalink to this headline">¶</a></h2>
<p>For your dataset to be compatible out of the box, it is a good practice to also add the metrics your dataset requires.
All metrics for now go inside <code class="docutils literal notranslate"><span class="pre">MMF/modules/metrics.py</span></code>. All metrics inherit <a class="reference internal" href="../lib/modules/metrics.html#mmf.modules.metrics.BaseMetric" title="mmf.modules.metrics.BaseMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMetric</span></code></a> and implement a function <code class="docutils literal notranslate"><span class="pre">calculate</span></code>
with signature <code class="docutils literal notranslate"><span class="pre">calculate(self,</span> <span class="pre">sample_list,</span> <span class="pre">model_output,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code> where <code class="docutils literal notranslate"><span class="pre">sample_list</span></code> (<a class="reference internal" href="../lib/common/sample.html#mmf.common.sample.SampleList" title="mmf.common.sample.SampleList"><code class="xref py py-class docutils literal notranslate"><span class="pre">SampleList</span></code></a>) is the current batch and
<code class="docutils literal notranslate"><span class="pre">model_output</span></code> is a dict return by your model for current <code class="docutils literal notranslate"><span class="pre">sample_list</span></code>. Normally, you should define the keys you want inside
<code class="docutils literal notranslate"><span class="pre">model_output</span></code> and <code class="docutils literal notranslate"><span class="pre">sample_list</span></code>. Finally, you should register your metric to registry using <code class="docutils literal notranslate"><span class="pre">&#64;registry.register_metric('[key]')</span></code>
where ‘[key]’ is the key for your metric. Here is a sample implementation of accuracy metric used in CLEVR dataset:</p>
<p>These are the common steps you need to follow when you are adding a dataset to MMF.</p>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="late_fusion.html" class="btn btn-neutral float-right" title="Tutorial: Late Fusion" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="concepts.html" class="btn btn-neutral" title="Terminology and Concepts" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Facebook AI Research.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Tutorial: Adding a dataset</a><ul>
<li><a class="reference internal" href="#dataset-builder">Dataset Builder</a></li>
<li><a class="reference internal" href="#default-configuration">Default Configuration</a></li>
<li><a class="reference internal" href="#dataset-class">Dataset Class</a></li>
<li><a class="reference internal" href="#metrics">Metrics</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->


  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://mmf.sh/" class="footer-logo"></a>
      </div>
      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://mmf.sh/">MMF</a></li>
            <li><a href="https://mmf.sh/get-started">Get Started</a></li>
            <li><a href="https://mmf.sh/features">Features</a></li>
            <li><a href="https://github.com/facebookresearch/master/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Resources</a></li>
            <li><a href="https://mmf.sh/tutorials">Tutorials</a></li>
            <li><a href="https://mmf.sh/docs/stable/index.html">Docs</a></li>
            <li><a href="https://github.com/facebookresearch/master/issues" target="_blank">Github Issues</a></li>
          </ul>
        </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://mmf.sh/" aria-label="MMF"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://mmf.sh/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://mmf.sh/features">Features</a>
          </li>

          <li>
            <a href="https://mmf.sh/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://mmf.sh/docs/stable/index.html">Docs</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/mmf">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>