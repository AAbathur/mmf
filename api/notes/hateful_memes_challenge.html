


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hateful Memes &mdash; MMF 1.0.0rc8 documentation</title>
  

  
  
  
  
    <link rel="canonical" href="/notes/hateful_memes_challenge.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/css/customize.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Terminology and Concepts" href="../tutorials/concepts.html" />
    <link rel="prev" title="FAQs" href="faq.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://mmf.sh/" aria-label="MMF"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://mmf.sh/get-started">Get Started</a>
          </li>


          <li>
            <a href="https://mmf.sh/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://mmf.sh/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://github.com/facebookresearch/mmf">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  1.0.0
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart </a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="pretrained_models.html">Pretrained Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration System</a></li>
<li class="toctree-l1"><a class="reference internal" href="challenge.html">Challenge Participation</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQs</a></li>
</ul>
<p class="caption"><span class="caption-text">Challenges</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hateful Memes</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending MMF</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/concepts.html">Terminology and Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dataset.html">Tutorial: Adding a dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/late_fusion.html">Tutorial: Late Fusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/mmf_bert.html">Tutorial: Detect Hate Speech with MMFBERT</a></li>
</ul>
<p class="caption"><span class="caption-text">Library Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lib/common/registry.html">common.registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/common/sample.html">common.sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/models/base_model.html">models.base_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/modules/losses.html">modules.losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/modules/metrics.html">modules.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/datasets/base_dataset_builder.html">datasets.base_dataset_builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/datasets/base_dataset.html">datasets.base_dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/datasets/processors.html">datasets.processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib/utils/text.html">utils.text</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Hateful Memes</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/notes/hateful_memes_challenge.md.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="hateful-memes">
<h1>Hateful Memes<a class="headerlink" href="#hateful-memes" title="Permalink to this headline">Â¶</a></h1>
<p>The Hateful Memes challenge is available at <a class="reference external" href="https://www.drivendata.org/competitions/64/hateful-memes">this link</a>.</p>
<p>In MMF, we provide the starter code and baseline pretrained models for this challenge and the configurations used for training the reported baselines. For more details check <a class="reference external" href="https://github.com/facebookresearch/mmf/tree/master/projects/hateful_memes">this link</a>.</p>
<p>In this tutorial, we provide steps for running training and evaluation with MMBT model on hateful memes dataset and generating submission file for the challenge. The same steps can be used for your own models.</p>
<div class="section" id="installation-and-preparing-the-dataset">
<h2>Installation and Preparing the dataset<a class="headerlink" href="#installation-and-preparing-the-dataset" title="Permalink to this headline">Â¶</a></h2>
<p>Follow the prerequisites for installation and dataset <a class="reference external" href="https://github.com/facebookresearch/mmf/tree/master/projects/hateful_memes#prerequisites">here</a>.</p>
</div>
<div class="section" id="training-and-evaluation">
<h2>Training and Evaluation<a class="headerlink" href="#training-and-evaluation" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="training">
<h3>Training<a class="headerlink" href="#training" title="Permalink to this headline">Â¶</a></h3>
<p>For running training on train set, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mmf_run</span> <span class="n">config</span><span class="o">=</span><span class="n">projects</span><span class="o">/</span><span class="n">hateful_memes</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">mmbt</span><span class="o">/</span><span class="n">defaults</span><span class="o">.</span><span class="n">yaml</span> <span class="n">model</span><span class="o">=</span><span class="n">mmbt</span> <span class="n">dataset</span><span class="o">=</span><span class="n">hateful_memes</span> <span class="n">training</span><span class="o">.</span><span class="n">run_type</span><span class="o">=</span><span class="n">train_val</span>
</pre></div>
</div>
<p>This will train the <code class="docutils literal notranslate"><span class="pre">mmbt</span></code> model on the dataset and generate the checkpoints and best trained model (<code class="docutils literal notranslate"><span class="pre">mmbt_final.pth</span></code>) will be stored in the <code class="docutils literal notranslate"><span class="pre">./save</span></code> directory by default.</p>
</div>
<div class="section" id="evaluation">
<h3>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this headline">Â¶</a></h3>
<p>Next run evaluation on the validation set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mmf_run</span> <span class="n">config</span><span class="o">=</span><span class="n">projects</span><span class="o">/</span><span class="n">hateful_memes</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">mmbt</span><span class="o">/</span><span class="n">defaults</span><span class="o">.</span><span class="n">yaml</span> <span class="n">model</span><span class="o">=</span><span class="n">mmbt</span> <span class="n">dataset</span><span class="o">=</span><span class="n">hateful_memes</span> <span class="n">training</span><span class="o">.</span><span class="n">run_type</span><span class="o">=</span><span class="n">val</span> <span class="n">resume_file</span><span class="o">=./</span><span class="n">save</span><span class="o">/</span><span class="n">mmbt_final</span><span class="o">.</span><span class="n">pth</span>
</pre></div>
</div>
<p>This will give you the performance of your model on the validation set. The metrics are AUROC, ACC, Binary F1 etc.</p>
</div>
</div>
<div class="section" id="predictions-for-challenge">
<h2>Predictions for Challenge<a class="headerlink" href="#predictions-for-challenge" title="Permalink to this headline">Â¶</a></h2>
<p>After we trained the model and evaluated on the validation set, we will generate the predictions on the test set. The prediction file should contain the following three columns:</p>
<ul class="simple">
<li><p>Meme identification number, <code class="docutils literal notranslate"><span class="pre">id</span></code></p></li>
<li><p>Probability that the meme is hateful, <code class="docutils literal notranslate"><span class="pre">proba</span></code></p></li>
<li><p>Binary label that the meme is hateful (1) or non-hateful (0), <code class="docutils literal notranslate"><span class="pre">label</span></code></p></li>
</ul>
<p>With MMF you can directly generate the predictions in the required submission format with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mmf_predict</span> <span class="n">config</span><span class="o">=</span><span class="n">projects</span><span class="o">/</span><span class="n">hateful_memes</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">mmbt</span><span class="o">/</span><span class="n">defaults</span><span class="o">.</span><span class="n">yaml</span> <span class="n">model</span><span class="o">=</span><span class="n">mmbt</span> <span class="n">dataset</span><span class="o">=</span><span class="n">hateful_memes</span> <span class="n">run_type</span><span class="o">=</span><span class="n">test</span>
</pre></div>
</div>
<p>This command will output where the generated predictions csv file is stored.</p>
</div>
<div class="section" id="submission-for-challenge">
<h2>Submission for Challenge<a class="headerlink" href="#submission-for-challenge" title="Permalink to this headline">Â¶</a></h2>
<p>Next you can upload the generated csv file on DrivenData in their <a class="reference external" href="https://www.drivendata.org/competitions/64/hateful-memes/submissions/">submissions</a> page for Hateful Memes.</p>
<p>More details will be added once the challenge submission phase is live.</p>
</div>
<div class="section" id="building-on-top-of-mmf-and-open-sourcing-your-code">
<h2>Building on top of MMF and Open Sourcing your code<a class="headerlink" href="#building-on-top-of-mmf-and-open-sourcing-your-code" title="Permalink to this headline">Â¶</a></h2>
<p>To understand how you build on top of MMF for your own custom models and then open source your code, take a look at this <a class="reference external" href="https://github.com/apsdehal/hm_example_mmf">example</a>.</p>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tutorials/concepts.html" class="btn btn-neutral float-right" title="Terminology and Concepts" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="faq.html" class="btn btn-neutral" title="FAQs" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Facebook AI Research.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Hateful Memes</a><ul>
<li><a class="reference internal" href="#installation-and-preparing-the-dataset">Installation and Preparing the dataset</a></li>
<li><a class="reference internal" href="#training-and-evaluation">Training and Evaluation</a><ul>
<li><a class="reference internal" href="#training">Training</a></li>
<li><a class="reference internal" href="#evaluation">Evaluation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#predictions-for-challenge">Predictions for Challenge</a></li>
<li><a class="reference internal" href="#submission-for-challenge">Submission for Challenge</a></li>
<li><a class="reference internal" href="#building-on-top-of-mmf-and-open-sourcing-your-code">Building on top of MMF and Open Sourcing your code</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
         <script src="../_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->


  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://mmf.sh/" class="footer-logo"></a>
      </div>
      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://mmf.sh/">MMF</a></li>
            <li><a href="https://mmf.sh/get-started">Get Started</a></li>
            <li><a href="https://mmf.sh/features">Features</a></li>
            <li><a href="https://github.com/facebookresearch/master/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Resources</a></li>
            <li><a href="https://mmf.sh/tutorials">Tutorials</a></li>
            <li><a href="https://mmf.sh/docs/stable/index.html">Docs</a></li>
            <li><a href="https://github.com/facebookresearch/master/issues" target="_blank">Github Issues</a></li>
          </ul>
        </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebookâs Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://mmf.sh/" aria-label="MMF"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://mmf.sh/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://mmf.sh/features">Features</a>
          </li>

          <li>
            <a href="https://mmf.sh/tutorials">Tutorials</a>
          </li>

          <li class="active">
            <a href="https://mmf.sh/docs/stable/index.html">Docs</a>
          </li>
          <li>
            <a href="https://github.com/facebookresearch/mmf">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>