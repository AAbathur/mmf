<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.56">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-135079836-2","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135079836-2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-135079836-2",{})</script><title data-react-helmet="true">Pretrained Models | MMF</title><meta data-react-helmet="true" property="og:image" content="https://mmf.sh/img/logo.png"><meta data-react-helmet="true" property="twitter:image" content="https://mmf.sh/img/logo.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for MMF"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Pretrained Models | MMF"><meta data-react-helmet="true" name="description" content="[Outdated] A new version of this will be uploaded soon"><meta data-react-helmet="true" property="og:description" content="[Outdated] A new version of this will be uploaded soon"><meta data-react-helmet="true" property="og:url" content="https://mmf.sh/docs/notes/pretrained_models"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://mmf.sh/docs/notes/pretrained_models"><link rel="stylesheet" href="/styles.b4193a3f.css">
<link rel="preload" href="/styles.7d81d555.js" as="script">
<link rel="preload" href="/runtime~main.625b4258.js" as="script">
<link rel="preload" href="/main.ab346157.js" as="script">
<link rel="preload" href="/1.9d02468d.js" as="script">
<link rel="preload" href="/2.0e62abef.js" as="script">
<link rel="preload" href="/21.1c657de4.js" as="script">
<link rel="preload" href="/20ac7829.3e565e31.js" as="script">
<link rel="preload" href="/3004447a.3902d663.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/banner_logo.svg" alt="MMF Logo"><strong class="navbar__title"></strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/api_redirect">API</a><a href="https://github.com/facebookresearch/mmf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/banner_logo.svg" alt="MMF Logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/api_redirect">API</a></li><li class="menu__list-item"><a href="https://github.com/facebookresearch/mmf" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/features">MMF Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/quickstart">Quickstart</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting_started/faqs">FAQs</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/concepts">Terminology and Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/configuration">Configuration System</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/notes/pretrained_models">Pretrained Models</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/dataset">Adding a dataset</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorials/late_fusion">Late Fusion</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Challenges</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/challenges/hateful_memes_challenge">Hateful Memes Challenge</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/challenges/other_challenges">Other Challenges</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Pretrained Models</h1></header><div class="markdown"><p><strong>[Outdated]</strong> A new version of this will be uploaded soon</p><p>Performing inference using pretrained models in MMF is easy. Pickup a pretrained
model from the table below and follow the steps to do inference or generate
predictions for EvalAI evaluation. This section expects that you have already installed the
required data as explained in <a href="/docs/notes/quickstart">quickstart</a>.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-eval_rst codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+-----------+---------------------------------------+---------------------------------------------------+-----------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| Model  | Model Key | Supported Datasets                    | Pretrained Models                                 | Notes                                                     |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+-----------+---------------------------------------+---------------------------------------------------+-----------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| Pythia | pythia    | vqa2, vizwiz, textvqa, visual_genome, | `vqa2 train+val`_, `vqa2 train only`_,  `vizwiz`_ | VizWiz model has been pretrained on VQAv2 and transferred |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+-----------+---------------------------------------+---------------------------------------------------+-----------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| LoRRA  | lorra     | vqa2, vizwiz, textvqa                 | `textvqa`_                                        |                                                           |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+-----------+---------------------------------------+---------------------------------------------------+-----------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| CNNLSTM| cnn_lstm  | clevr                                 |                                                   | Features are calculated on fly in this on                 |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+-----------+---------------------------------------+---------------------------------------------------+-----------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| BAN    | ban       | vqa2, vizwiz, textvqa                 | Coming soon!                                      | Support is preliminary and haven&#x27;t been tested throughly. |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+-----------+---------------------------------------+---------------------------------------------------+-----------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| BUTD   | butd      | coco                                  | `coco`_                                           |                                                           |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+-----------+---------------------------------------+---------------------------------------------------+-----------------------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.. _vqa2 train+val: https://dl.fbaipublicfiles.com/pythia/pretrained_models/vqa2/pythia_train_val.pth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.. _vqa2 train only: https://dl.fbaipublicfiles.com/pythia/pretrained_models/vqa2/pythia.pth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.. _vizwiz: https://dl.fbaipublicfiles.com/pythia/pretrained_models/vizwiz/pythia_pretrained_vqa2.pth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.. _textvqa: https://dl.fbaipublicfiles.com/pythia/pretrained_models/textvqa/lorra_best.pth</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.. _coco: https://dl.fbaipublicfiles.com/pythia/pretrained_models/coco_captions/butd.pth</span></div></div></div></div></div><p>Now, let&#x27;s say your link to pretrained model <code>model</code> is <code>link</code> (select from table &gt; right click &gt; copy link address), the respective config should be at
<code>configs/[task]/[dataset]/[model].yaml</code>. For example, config file for <code>vqa2 train_and_val</code> should be
<code>configs/vqa/vqa2/pythia_train_and_val.yaml</code>. Now to run inference for EvalAI, run the following command.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/mmf/data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir -p models &amp;&amp; cd models;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Download the pretrained model</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">wget [link]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd ../..;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">python tools/run.py --datasets [dataset] --model [model] --config [config] \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--run_type inference --evalai_inference 1 --resume_file data/[model].pth</span></div></div></div></div></div><p>If you want to train or evaluate on val, change the <code>run_type</code> to <code>train</code> or <code>val</code>
accordingly. You can also use multiple run types, for e.g. to do training, inference on
val as well as test you can set <code>--run_type</code> to <code>train+val+inference</code>.</p><p>if you remove <code>--evalai_inference</code> argument, Pythia will perform inference and provide results
directly on the dataset. Do note that this is not possible in case of test sets as we
don&#x27;t have answers/targets for them. So, this can be useful for performing inference
on val set locally.</p><p>Table below shows evaluation metrics for various pretrained models:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-eval_rst codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+--------------------+---------------------------------+----------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| Model  | Dataset            | Metric                          | Notes                                        |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+--------------------+---------------------------------+----------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| Pythia | vqa2 (train+val)   | test-dev accuracy - 68.31%      | Can be easily pushed to 69.2%                |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+--------------------+---------------------------------+----------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| Pythia | vqa2 (train)       | test-dev accuracy - 66.7%       |                                              |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+--------------------+---------------------------------+----------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| Pythia | vizwiz (train)     | test-dev accuracy - 54.22%      | Pretrained on VQA2 and transferred to VizWiz |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+--------------------+---------------------------------+----------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| LoRRA  | textvqa (train)    | val accuracy - 27.4%            |                                              |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+--------------------+---------------------------------+----------------------------------------------+</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|        |  coco              | | BLEU 1 - 76.02, BLEU 4- 35.42 |                                              |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">| BUTD   |  (karpathy-train)  | | METEOR- 27.39, ROUGE_L- 56.17 | Beam Search(length 5), Karpathy test split   |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">|        |                    | | CIDEr - 112.03, SPICE - 20.33 |                                              |</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">+--------+--------------------+---------------------------------+----------------------------------------------+</span></div></div></div></div></div><p><strong>Note for BUTD model :</strong>  For training BUTD model use the config <code>butd.yaml</code>. Training uses greedy decoding for validation. Currently we do not have support to train the model using beam search decoding validation. We will add that support soon. For inference only use <code>butd_beam_search.yaml</code> config that supports beam search decoding.</p><p><strong>Note</strong> that, for simplicity, our current released model <strong>does not</strong> incorporate extensive data augmentations (e.g. visual genome, visual dialogue) during training, which was used in our challenge winner entries for VQA and VizWiz 2018. As a result, there can be some performance gap to models reported and released previously. If you are looking for reproducing those results, please checkout the <a href="https://github.com/facebookresearch/mmf/releases/tag/v0.1">v0.1</a> release.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebookresearch/mmf/edit/master/website/docs/notes/pretrained_models.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-06-10T02:49:16.000Z" class="docLastUpdatedAt_1sqk">6/9/2020</time> by <strong>Amanpreet Singh</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/notes/configuration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« MMF&#x27;s Configuration System</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tutorials/dataset"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adding a dataset »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebookresearch/mmf" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Terms</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div>Copyright © 2020 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.7d81d555.js"></script>
<script src="/runtime~main.625b4258.js"></script>
<script src="/main.ab346157.js"></script>
<script src="/1.9d02468d.js"></script>
<script src="/2.0e62abef.js"></script>
<script src="/21.1c657de4.js"></script>
<script src="/20ac7829.3e565e31.js"></script>
<script src="/3004447a.3902d663.js"></script>
</body>
</html>